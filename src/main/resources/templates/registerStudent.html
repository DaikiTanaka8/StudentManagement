<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ja">
<!--「xmlns:th="http://www.thymeleaf.org"」→thがタイムリーフ専用のタグ、必須のもの。
     これを宣言しているから、「th:」で始まる属性はタイムリーフのものとして使える。-->
<head>
  <meta charset="UTF-8">
  <title>受講生登録</title>
</head>
<body>
<h1>受講生登録</h1>
<!--TODO：actionの参照先やobjectの型が合っているか確認-->
<form th:action="@{/registerStudent}" th:object="${studentDetail}" method="post">
<!--「th:action="@{/registerStudent}"」：アクションのURLは表示する時のものではなく、POSTメソッドのURL。
    コントローラーの「@PostMapping("/registerStudent")」に飛ばしている。
    「th:object="${studentDetail}"」：コントローラーの「public String registerStudent(StudentDetail studentDetail)」の引数。
    フォームの中に入力欄を作っていく。。。？
    「method="post"」：フォームというHTMLタグが元々持っている属性。-->
  <div> <!--一つのまとまり、というもの。-->
  <label for="name">名前</label> <!--ラベルの名前。nameですよ。studentDetailの要素と合わせなければならない。-->
    <input type="text" id="name" th:field="*{student.name}"
           required oninvalid="this.setCustomValidity('名前を入力してください')"
           oninput="this.setCustomValidity('')">
    <!--「required oninvalid」入力が空でinvalidになった時メッセージを上書き-->
    <!--「oninput="this.setCustomValidity('')"」入力されたらカスタムメッセージをクリアして通常状態を戻す。-->
    <!--input：入力項目。テキスト入力する項目。
        「th:field」：「${studentDetail}」に紐づくフィールド名はなんなのか。
        「*{student.name}」：studentDetail.student.nameをアスタリスクで省略している。-->
    <p th:if="${#fields.hasErrors('student.name')}" th:errors="*{student.name}"></p>
    <!--Springのサーバーサイドバリデーション（@NotBlank など） と連動。
        サーバー側のバリデーションでstudent.nameにエラーがある時だけ、バリデーションのメッセージを表示する。
        「@NotBlank(message = "名前は必須です")」がここに表示される。-->
  </div>
  <div>
    <label for="furigana">ふりがな</label>
    <input type="text" id="furigana" th:field="*{student.furigana}"
           required oninvalid="this.setCustomValidity('ふりがなを入力してください')"
           oninput="this.setCustomValidity('')">
    <p th:if="${#fields.hasErrors('student.furigana')}" th:errors="*{student.furigana}"></p>
  </div>
  <div>
    <label for="nickname">ニックネーム</label>
    <input type="text" id="nickname" th:field="*{student.nickname}">
  </div>
  <div>
    <label for="email">メールアドレス</label>
    <input type="text" id="email" th:field="*{student.email}"
           required oninvalid="this.setCustomValidity('メールアドレスを入力してください')"
           oninput="this.setCustomValidity('')">
    <p th:if="${#fields.hasErrors('student.email')}" th:errors="*{student.email}"></p>
  </div>
  <div>
    <label for="city">地域</label>
    <input type="text" id="city" th:field="*{student.city}"
           required oninvalid="this.setCustomValidity('地域を入力してください')"
           oninput="this.setCustomValidity('')">
    <p th:if="${#fields.hasErrors('student.city')}" th:errors="*{student.city}"></p>
  </div>
  <div>
    <label for="age">年齢</label>
    <input type="number" id="age" th:field="*{student.age}"
           required oninvalid="this.setCustomValidity('年齢を入力してください')"
           oninput="this.setCustomValidity('')">
    <p th:if="${#fields.hasErrors('student.age')}" th:errors="*{student.age}"></p>
  </div>
  <div>
    <label for="gender">性別</label>
    <select id="gender" th:field="*{student.gender}"
            required oninvalid="this.setCustomValidity('性別を選択してください')"
            oninput="this.setCustomValidity('')">
      <option value="">選択してください</option>
      <option value="男性">男性</option>
      <option value="女性">女性</option>
      <option value="その他">その他</option>
    </select>
    <p th:if="${#fields.hasErrors('student.gender')}" th:errors="*{student.gender}"></p>
  </div>
  <div>
    <label for="remark">備考</label>
    <input type="text" id="remark" th:field="*{student.remark}">
  </div>

  <div th:each="course, stat : *{studentCourse}"> <!--stat:タイムリーフの機能。Listだと数を数えてもらう（０始まりで数える）。studentCourseはStudentDetailがもつ要素のこと。 -->
    <label for="courseName">受講コース名</label>
    <input type="text" id="courseName"
           th:field="*{studentCourse[__${stat.index}__].courseName}" /> <!--studentCourseのcourseNameに設定するよ、ということ。-->
                  <!-- ↑StudentDetailの中のリスト/ ↑n番目 / ↑要素オブジェクトのcourseNameフィールド -->
    <!--「th:id="studentCourse.__${stat.index}__.courseName}"」講義内ではこれを入れて、idを上書きしている。labelの方もこれを入れている。 -->
  </div>

  <div>
    <button type="submit">登録</button>
    <!--登録するためのボタンを用意している。「type="submit"」：ボタンを押した瞬間、postとしてURLに対して処理が実行されるという動き。    -->
  </div>
</form>
</body>
</html>
